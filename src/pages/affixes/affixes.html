<template>
    <h3 class="text-center my-4">
        <span class="rarity-text">${filteredAffixes.length}</span> Magic Affixes Found
    </h3>

    <search-area>

        <div class="max-w-11/12 mx-auto px-4">
            <div class="flex flex-wrap justify-center items-start text-center">

                <div class="w-auto min-w-50 px-2">
                    <div class="relative mb-2">
                        <select id="ptype"
                                class="peer w-full bg-gray-800 border-1 border-gray-600 ring-0 focus:ring-0 focus:border-gray-400 rounded-lg type-text z-0"
                                value.bind="selectedPType" required>
                            <option repeat.for="opt of pTypeOptions" value.bind="opt.value">${opt.label}</option>
                        </select>
                        <label for="ptype"
                               class="pointer-events-none z-10 ml-1 origin-left bg-gray-800 type-text
                               absolute left-2 top-1/2 -translate-y-1/2 transition-all duration-200 transform
                               peer-focus:bg-transparent peer-focus:top-1 peer-focus:scale-75
                               peer-valid:bg-transparent peer-valid:top-1 peer-valid:scale-75
                               peer-invalid:top-1/2 peer-invalid:scale-100">Prefix/Suffix</label>
                    </div>
                </div>

                <div class="w-auto min-w-50 px-2">
                    <div class="relative mb-2">
                        <select id="desc"
                                class="peer w-full bg-gray-800 border-1 border-gray-600 ring-0 focus:ring-0 focus:border-gray-400 rounded-lg type-text z-0"
                                value.bind="selectedGroupDescription" required>
                            <option repeat.for="opt of groupOptions" value.bind="opt.value">${opt.label}</option>
                        </select>
                        <label for="desc"
                               class="pointer-events-none z-10 ml-1 origin-left bg-gray-800 type-text
                               absolute left-2 top-1/2 -translate-y-1/2 transition-all duration-200 transform
                               peer-focus:bg-transparent peer-focus:top-1 peer-focus:scale-75
                               peer-valid:bg-transparent peer-valid:top-1 peer-valid:scale-75
                               peer-invalid:top-1/2 peer-invalid:scale-100">Property Type</label>
                    </div>
                </div>
                <div class="w-auto min-w-50 px-2">
                    <div class="relative">
                        <select id="itype"
                                class="peer w-full bg-gray-800 border-1 border-gray-600 ring-0 focus:ring-0 focus:border-gray-400 rounded-lg type-text z-0"
                                value.bind="selectedType" required>
                            <option repeat.for="opt of types"
                                    value.bind="opt.value && opt.value.length ? opt.value[0] : ''">${opt.label}
                            </option>
                        </select>
                        <label for="itype"
                               class="pointer-events-none z-10 ml-1 origin-left bg-gray-800 type-text
                               absolute left-2 top-1/2 -translate-y-1/2 transition-all duration-200 transform
                               peer-focus:bg-transparent peer-focus:top-1 peer-focus:scale-75
                               peer-valid:bg-transparent peer-valid:top-1 peer-valid:scale-75
                               peer-invalid:top-1/2 peer-invalid:scale-100">Item Type</label>
                    </div>
                    <label for="exacttype" class="block my-2 type-text">
                        <input id="exacttype" type="checkbox" class="mr-2" checked.bind="exclusiveType">Exact Type Only
                    </label>
                </div>
            <div class="w-auto min-w-50 px-2">
                <div class="relative mb-2">
                    <input id="tokensearch"
                           class="peer w-full bg-gray-800 border-1 border-gray-600 ring-0 focus:ring-0 focus:border-gray-400 rounded-lg type-text z-0"
                           type="text" value.bind="search" required/>
                    <label for="tokensearch"
                           class="pointer-events-none z-10 ml-1 origin-left bg-gray-800
                               absolute left-2 top-1/2 -translate-y-1/2 transition-all duration-200 transform
                               peer-focus:bg-transparent peer-focus:top-1 peer-focus:scale-75
                               peer-valid:bg-transparent peer-valid:top-1 peer-valid:scale-75
                               peer-invalid:top-1/2 peer-invalid:scale-100">Filter by Input</label>
                </div>
            </div>
            <div class="w-auto px-2 flex flex-nowrap">
                <div class="min-w-32 relative mr-2">
                    <select id="minrlvl"
                            class="peer w-full bg-gray-800 border-1 border-gray-600 ring-0 focus:ring-0 focus:border-gray-400 rounded-lg type-text z-0"
                            value.bind="minRequiredLevel" required>
                        <option value="">Any</option>
                        <option repeat.for="opt of rLevelOptions" value.bind="opt.value">${opt.label}</option>
                    </select>
                    <label for="minrlvl"
                           class="pointer-events-none z-10 ml-1 origin-left bg-gray-800 type-text
                       absolute left-2 top-1/2 -translate-y-1/2 transition-all duration-200 transform
                       peer-focus:bg-transparent peer-focus:top-1 peer-focus:scale-75
                       peer-valid:bg-transparent peer-valid:top-1 peer-valid:scale-75
                       peer-invalid:top-1/2 peer-invalid:scale-100">Min rLvl</label>
                </div>
                <div class="min-w-32 relative ml-2">
                    <select id="maxrlvl"
                            class="peer w-full bg-gray-800 border-1 border-gray-600 ring-0 focus:ring-0 focus:border-gray-400 rounded-lg type-text z-0"
                            value.bind="maxRequiredLevel" required>
                        <option value="">Any</option>
                        <option repeat.for="opt of rLevelOptions" value.bind="opt.value">${opt.label}</option>
                    </select>
                    <label for="maxrlvl"
                           class="pointer-events-none z-10 ml-1 origin-left bg-gray-800 type-text
                       absolute left-2 top-1/2 -translate-y-1/2 transition-all duration-200 transform
                       peer-focus:bg-transparent peer-focus:top-1 peer-focus:scale-75
                       peer-valid:bg-transparent peer-valid:top-1 peer-valid:scale-75
                       peer-invalid:top-1/2 peer-invalid:scale-100">Max rLvl</label>
                </div>
                <div class="w-auto min-w-32 px-2">
                <div class="mb-2">
                    <button id="filterreset"
                            class="w-full bg-red-900 hover:bg-red-600 border border-gray-600 hover:border-gray-400 type-text rounded-lg p-2"
                            type="button" click.trigger="resetFilters()">Reset Filters
                    </button>
                </div>
            </div>
        </div>
        </div>
        </div>
    </search-area>

    <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-2 px-2 text-center mt-5">
        <div class="bg-gray-800 rounded shadow p-2" repeat.for="affix of filteredAffixes">
            <div class="flex justify-between items-center">
                <div class="prop-text mt-1 ml-1">${affix.Name}</div>
                <div class="type-text mt-1 mr-1">${affix.PType}</div>
            </div>
            <div class="requirement-text mb-1">Level ${affix.RequiredLevel > 0 ? affix.RequiredLevel : 1} Required
            </div>
            <div class="type-text mb-1" if.bind="affix.Level">Affix Level ${affix.Level}${affix.MaxLevel ? ' - ' +
                affix.MaxLevel : ''}
            </div>
            <div class="flex flex-wrap justify-center" if.bind="affix.Types && affix.Types.length">
                <span class="set-text mx-1" repeat.for="t of affix.Types">${t}</span>
            </div>
            <div class="flex flex-wrap justify-center" if.bind="affix.ETypes && affix.ETypes.length">
                <span class="requirement-text mx-1" repeat.for="et of affix.ETypes">${et}</span>
            </div>
            <div class="prop-text my-1" repeat.for="prop of affix.Properties">${prop.PropertyString}</div>
        </div>
    </div>
</template>
