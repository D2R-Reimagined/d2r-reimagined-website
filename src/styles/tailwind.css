@import "tailwindcss";

@plugin "flowbite/plugin";

/* Remove annoying layout shift when filtering to empty and define base scrollbars */
@layer base {
    html {
        overflow-y: scroll;
    }

    /* Themed scrollbars (track uses bg-gray-900 + border-gray-600; thumb/buttons reversed) */
    /* Firefox */
    :root {
        /* thumb color, track color */
        scrollbar-color: #4b5563 #111827; /* gray-600 thumb on gray-900 track */
        scrollbar-width: thin;
    }

    /* WebKit-based browsers (Chromium, Safari, Edge) */
    *::-webkit-scrollbar {
        width: 12px;
        height: 12px;
        background-color: transparent;
    }

    *::-webkit-scrollbar-track {
        background-color: #111827; /* gray-900 */
        border: 1px solid #4b5563; /* gray-600 */
    }

    *::-webkit-scrollbar-thumb {
        background-color: #4b5563; /* gray-600 */
        border: 1px solid #111827; /* gray-900 */
        border-radius: 9999px; /* pill */
        background-clip: padding-box;
    }

    /* Optional: scrollbar corner when both bars are visible */
    *::-webkit-scrollbar-corner {
        background-color: #111827; /* gray-900 */
        border: 1px solid #4b5563; /* gray-600 */
    }

    /* Scrollbar buttons (arrows) — many browsers hide these, but style for when shown */
    *::-webkit-scrollbar-button {
        background-color: #4b5563; /* gray-600 */
        border: 1px solid #111827; /* gray-900 */
        width: 12px;
        height: 12px;
    }
}

/* MSO Size Fix for text-size tags and shorten class tag*/
@utility mso {
    font-family: 'Material Symbols Outlined', serif;
    font-weight: normal;
    font-style: normal;
    font-size: inherit;
    line-height: 1;
    letter-spacing: normal;
    text-transform: none;
    display: inline-block;
    white-space: nowrap;
    word-wrap: normal;
    direction: ltr;
    -webkit-font-feature-settings: 'liga';
    -webkit-font-smoothing: antialiased;
    font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
}

/* Base select style for floating label. Use: class="select-base peer" */
@utility select-base {
    @apply w-full rounded-lg z-0 ring-0 outline-none
    bg-gray-800 border border-gray-600 text-base type-text px-3 py-2;
    /* So I can make differences if required. */
    &:hover {
        @apply ring ring-gray-200;
    }

    &:disabled {
        @apply ring-0 bg-gray-900 border-gray-700;
    }

    &:focus {
        @apply ring ring-gray-200;
    }
}

/* Base select style for floating label next to exact button. Use: class="select-base-exact peer" */
@utility select-base-exact {
    @apply w-full border border-r-0 rounded-l-lg z-0 ring-0 outline-none
    bg-gray-800 border-gray-600 text-base type-text px-3 py-2;
    /* So I can make differences if required. */
    &:hover {
        @apply ring ring-gray-200;
    }

    &:disabled {
        @apply ring-0 bg-gray-900 border-gray-700;
    }

    &:focus {
        @apply ring ring-gray-200;
    }
}

/* Exact toggle button used alongside select-base-exact Use: class="exact-button" */
@utility exact-button {
    @apply flex items-center px-3 py-2 rounded-r-lg bg-gray-800 gap-1 text-base type-text
    border border-gray-600;

    /* Hover shows a subtle focus ring */
    &:hover {
        @apply ring ring-gray-200;
    }

    /* Keyboard focus should also show the subtle ring */
    &:focus,
    &:focus-visible {
        @apply ring ring-gray-200;
    }

    /* Active state when toggled on */
    &[aria-pressed="true"] {
        @apply ring ring-gray-400;
    }

    /* When toggled and hovered/focused, the subtle ring should override */
    &[aria-pressed="true"]:hover,
    &[aria-pressed="true"]:focus,
    &[aria-pressed="true"]:focus-visible {
        @apply ring ring-gray-200;
    }

    /* Indicator chip inside the button */
    .exact-indicator {
        @apply h-2 w-3 rounded-l-full bg-gray-900 border border-gray-600;
    }

    /* Indicator color when active */
    &[aria-pressed="true"] .exact-indicator {
        @apply bg-lime-500;
    }
}

/*Base label style use: class="floating-label" */
@utility floating-label {
    @apply pointer-events-none outline-none z-10 ml-1 origin-left
    absolute left-2 top-1/2 -translate-y-1/2
    transform transition-all duration-200
    bg-gray-800 text-base type-text;
}

@layer utilities {
    /* Inputs: use placeholder to control resting vs. floated state */
    input.peer:placeholder-shown ~ .floating-label {
        @apply top-1/2 -translate-y-1/2 scale-100;
    }

    input.peer:focus ~ .floating-label,
    input.peer:not(:placeholder-shown) ~ .floating-label {
        @apply bg-transparent top-1 -translate-y-2/5 scale-75;
    }

    /* Selects: float when focused or when a non-empty option is selected */
    select.peer:focus ~ .floating-label,
    select.peer:has(option:checked:not([value=""])) ~ .floating-label {
        @apply bg-transparent top-1 -translate-y-2/5 scale-75;
    }

    .peer:disabled ~ .floating-label {
        @apply bg-gray-900 text-gray-500;
    }

    /* MSO Float compatibility */
    .floating-label .material-symbols-outlined {
        vertical-align: -0.25em;
        line-height: 1;
    }

    /* Rings: consistent behavior for inputs/selects */
    /* Inputs: subtle ring on hover/focus, stronger ring when value present (placeholder not shown) */
    input.peer:hover:not(:disabled),
    input.peer:focus:not(:disabled) {
        @apply ring ring-gray-200;
    }

    /* Lower specificity so :focus can override */
    :where(input.peer:not(:placeholder-shown)):not(:disabled) {
        @apply ring ring-gray-400;
    }

    /* Focus should override the filled state */
    input.peer:focus:not(:disabled) {
        @apply ring ring-gray-200;
    }

    /* Selects: subtle ring on hover/focus, stronger ring when a non-empty option is selected */
    select.peer:hover:not(:disabled),
    select.peer:focus:not(:disabled) {
        @apply ring ring-gray-200;
    }

    /* Lower specificity so :focus can override */
    :where(select.peer:has(option:checked:not([value=""]))):not(:disabled) {
        @apply ring ring-gray-400;
    }

    /* Focus should override the selected state */
    select.peer:focus:not(:disabled) {
        @apply ring ring-gray-200;
    }
}

/* Trailing Material Symbols icon rendered without extra DOM */
@utility trailing-icon {
    @apply relative;
}
.trailing-icon::after {
    content: attr(data-icon);
    font-family: 'Material Symbols Outlined', serif;
    font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
    -webkit-font-feature-settings: 'liga';
    @apply absolute inset-y-0 end-0 flex items-center pointer-events-none
    px-3 py-2 border-l border-gray-600 text-base base-text;
}

/* Base button style use: class="button-base" */
@utility button-base {
    @apply w-full px-3 py-2 border rounded-lg cursor-pointer text-base
    border-red-600 text-red-600 bg-gray-800;

    &:hover {
        @apply ring ring-gray-200 type-text bg-red-800;
    }
}

/* Vanilla toggle button (stand-alone) */
@utility vanilla-button {
    @apply w-full flex items-center justify-between px-3 py-2 rounded-lg bg-gray-800 gap-1 text-base type-text
    border border-gray-600;

    /* Hover shows a subtle focus ring */
    &:hover {
        @apply ring ring-gray-200;
    }

    /* Keyboard focus should also show the subtle ring */
    &:focus,
    &:focus-visible {
        @apply ring ring-gray-200;
    }

    /* Active state when toggled on */
    &[aria-pressed="true"] {
        @apply ring ring-gray-400;
    }

    /* When toggled and hovered/focused, the subtle ring should override */
    &[aria-pressed="true"]:hover,
    &[aria-pressed="true"]:focus,
    &[aria-pressed="true"]:focus-visible {
        @apply ring ring-gray-200;
    }

    /* Indicator chip inside the button */
    .vanilla-indicator {
        @apply h-2 w-3 rounded-full bg-gray-900 border border-gray-600;
    }

    /* Indicator color when active */
    &[aria-pressed="true"] .vanilla-indicator {
        @apply bg-lime-500;
    }
}

/* Reusable toggle switch track (used in grail.html) */
.grail-toggle {
    @apply relative inline-block w-9 h-5 rounded-full border bg-gray-800 border-gray-600 hover:border-gray-300 type-text;
}

/* Knob */
.grail-toggle::after {
    content: '';
    @apply absolute top-1/2 -translate-y-1/2 left-0.5 h-4 w-4 rounded-full border border-gray-600 hover:border-gray-300 bg-current transition duration-200;
}

/* State via peer (adjacent input) */
.peer:checked + .grail-toggle {
    @apply bg-lime-500 border-gray-400;
}

.peer:checked + .grail-toggle::after {
    @apply translate-x-4;
}

/* A11y/focus/disabled */
.peer:focus-visible + .grail-toggle {
    @apply ring ring-gray-300;
}

.peer:disabled + .grail-toggle {
    @apply opacity-50 cursor-not-allowed;
}

/* Change LG Breakpoint for mobile compatability with sticky and filter element layout*/
@theme {
    --breakpoint-lg: 1025px;
}

/* Card defaults */
.card-container {
    @apply grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-2 text-center p-5
}

.card-box {
    @apply bg-gray-800 rounded-lg border border-gray-600 p-2
}

/* Use on card repeat.for loops to help with window freezing on resize */
.card-vis {
    content-visibility: auto;
    contain: content;
    contain-intrinsic-size: 540px;
}

/* Mobile Information Button Class (shows up to the right of the filters at 1024 or less */
.m-info-button {
    @apply lg:hidden inline-flex items-center self-center ml-2 p-3
    rounded-lg bg-gray-800 border border-gray-600
    aria-expanded:ring aria-expanded:ring-gray-200
    text-base type-text
}

/* Unified tooltip styles */
@utility tooltip-base {
    @apply absolute z-50 invisible min-w-50 max-w-1/3 opacity-0 rounded-lg px-3 py-2
    bg-gray-900 border border-gray-600 text-base type-text shadow-sm;
}

@utility tooltip-trigger {
    @apply cursor-help;
}

/* Inline info panel (mobile) */
@utility info-panel-base {
    @apply block w-full rounded-lg px-3 py-2 bg-gray-950 border border-gray-600 text-base type-text;
}

/* Text Colors repeatedly used */
.link-text {
    @apply text-gray-50
}

.link-text:hover {
    @apply unique-text

}

@utility unique-text {
    color: #c7b790;
}

@utility type-text {
    @apply text-gray-50
}

.set-text {
    color: #249a24;
}

.set-text-light {
    color: #4cc238;
}

@utility base-text {
    @apply text-gray-400
}

.prop-text {
    color: #6377ef;
}

.requirement-text {
    color: #e84a4a;
}

.rarity-text {
    color: #63c7ef;
}